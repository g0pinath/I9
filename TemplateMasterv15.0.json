{
    "$schema": "http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#",
    "contentVersion": "1.0.0.0",
    "parameters": {
        
        
        "virtualMachineName": {"type": "array"},
        "virtualMachineSize": {"type": "array"},
        "virtualNetworkName": {"type": "array"},
        "vmimagetype": {"type": "array"},
        "osPublisher": {"type": "array"},
        "osOffer": {"type": "array"},
        "osSKU": {"type": "array"},
        "osType": {"type": "array"},
        "subnetName": {"type": "array"},
        "adminUsername": {"type": "string"},
        "domainPassword": {"type": "securestring"},
        "localadminPassword": {"type": "securestring"},
        "P7Pair": {"type": "array"},
        "PublicIPRequired":{"type": "array"},
        "publicIpAddressType": {"type": "string"},
        "publicIpAddressSku":  {"type": "string"},
        "PrivateIP": {"type": "array"},
        "isIM94Machine": {"type": "array"},        
        "FDiskAccountType": {"type": "array"}, 
        "FDiskSize": {"type": "array"},
        "FDiskCreateOption": {"type": "array"}, 
        "storageAccountName": {"type": "string"},
        "diagnosticsStorageAccountName": {"type": "string"},
        "diagnosticsStorageAccountType": {"type": "string"},
        "diagnosticsStorageAccountKind": {"type": "string"},
        "diagnosticsStorageAccountId": {"type": "string"},
        "networkSecurityGroupName": {"type": "array"}
        
    },
    "variables": {
       
        "count": "[length(parameters('virtualMachineName'))]",
        "subscriptionId": "[subscription().subscriptionId]",
       "VMTemplateURI": "https://raw.githubusercontent.com/g0pinath/I9New/master/TemplateChildv15.0.json"
       
    },
    "resources": [
         {
            "apiVersion": "2017-05-10",
             "name": "[concat('linkedTemplate', copyIndex())]",
            "type": "Microsoft.Resources/deployments",
            "copy": {
                    "Name":"childtemplatecopy",
                    "Count": "[variables('count')]"
                    },
            "properties": {
                "mode": "Incremental",
                "templateLink": {
                    "uri": "[variables('VMTemplateURI')]",
                    "contentVersion": "1.0.0.0"
                },
                 "parameters": { 

"virtualMachineName" : {"value": "parameters('virtualMachineName')[copyIndex(childtemplatecopy,0)]"},
"virtualMachineSize" : {"value": "parameters('virtualMachineSize')[copyIndex(childtemplatecopy,0)]"},
"virtualNetworkName" : {"value": "parameters('virtualNetworkName')[copyIndex(childtemplatecopy,0)]"},
"vmimagetype" : {"value": "parameters('vmimagetype')[copyIndex(childtemplatecopy,0)]"},
"osPublisher" : {"value": "parameters('osPublisher')[copyIndex(childtemplatecopy,0)]"},
"osOffer" : {"value": "parameters('osOffer')[copyIndex(childtemplatecopy,0)]"},
"osSKU" : {"value": "parameters('osSKU')[copyIndex(childtemplatecopy,0)]"},
"osType" : {"value": "parameters('osType')[copyIndex(childtemplatecopy,0)]"},
"subnetName" : {"value": "parameters('subnetName')[copyIndex(childtemplatecopy,0)]"},

"adminUsername": {"value": "parameters('adminusername')"},
"localadminPassword": {"value": "parameters('localadminPassword')"},
"domainPassword": {"value": "parameters('domainPassword')"},

                
"P7Pair" : {"value": "parameters('P7Pair')[copyIndex(childtemplatecopy,0)]"},
"PublicIPRequired" : {"value": "parameters('PublicIPRequired')[copyIndex(childtemplatecopy,0)]"},
"publicIpAddressType": {"value": "parameters('publicIpAddressType')"},
"publicIpAddressSku": {"value": "parameters('publicIpAddressSku')"},
"PrivateIP" : {"value": "parameters('PrivateIP')[copyIndex(childtemplatecopy,0)]"},
                

"isIM94Machine" : {"value": "parameters('isIM94Machine')[copyIndex(childtemplatecopy,0)]"},
"FDiskAccountType" : {"value": "parameters('FDiskAccountType')[copyIndex(childtemplatecopy,0)]"},
"FDiskSize" : {"value": "parameters('FDiskSize')[copyIndex(childtemplatecopy,0)]"},
"FDiskCreateOption" : {"value": "parameters('FDiskCreateOption')[copyIndex(childtemplatecopy,0)]"},
              

           
"storageAccountName": {"value": "parameters('storageAccountName')"},
"diagnosticsStorageAccountName": {"value": "parameters('diagnosticsStorageAccountName')"},
"diagnosticsStorageAccountType": {"value": "parameters('diagnosticsStorageAccountType')"},
"diagnosticsStorageAccountKind": {"value": "parameters('diagnosticsStorageAccountKind')"},
"diagnosticsStorageAccountId": {"value": "parameters('diagnosticsStorageAccountId')"},
"networkSecurityGroupName" : {"value": "parameters('networkSecurityGroupName')[copyIndex(childtemplatecopy,0)]"}
                
                }
            }
               
            }
        
     ],
    "outputs": {
        "adminUsername": {
            "type": "string",
            "value": "[parameters('adminUsername')]"
        }
    }
}